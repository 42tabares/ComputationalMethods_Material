---
redirect_from:
  - "/features/lagrangepoly"
interact_link: content/features/LagrangePoly.ipynb
kernel_name: python3
kernel_path: content/features
has_widgets: false
title: |-
  Lagrange polynomials
pagenum: 4
prev_page:
  url: /features/interpolation.html
next_page:
  url: /features/interpolation_details.html
suffix: .ipynb
search: x lagrange n l polynomial f sympy implementation colab interpolation com form polynomials research google github pn sum xi wikipedia function qquad text href restrepo computationalmethods blob master material lagrangepoly ipynb target parentimg src assets badge svg alt open based code gist folkertdev cca approx yil references en org wiki lagrangepolynomial interpolating example tree points degree numpy scipy simpy check expliclty p using lp polyl properties xj quad neq j objects python actividad fit cuatro puntos comprobando las propiedades del ploinomio de

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Lagrange polynomials</div>
</div>
    
<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/restrepo/ComputationalMethods/blob/master/material/LagrangePoly.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Interpolation-polynomial-in-the-Lagrange-form">Interpolation polynomial in the Lagrange form<a class="anchor-link" href="#Interpolation-polynomial-in-the-Lagrange-form"> </a></h1><p>Based on <a href="https://gist.github.com/folkertdev/084c53887c49a6248839">this code</a></p>
$$f(x)\approx P_n(x)\,,$$$$P_n(x) = \sum_{i=0}^n f(x_i)L_{n,i}(x) = \sum_{i=0}^n y_iL_{n,i}(x)$$<p><strong>References:</strong>
<a href="https://en.wikipedia.org/wiki/Lagrange_polynomial">Wikipedia</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="We-will-use-SymPy">We will use SymPy<a class="anchor-link" href="#We-will-use-SymPy"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">simplify</span><span class="p">,</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">factor</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span> <span class="c1">#..., lambdify, solve_poly_system</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">simplify</span><span class="p">(</span><span class="s1">&#39;2/3+5/6&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>3/2</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">expand</span><span class="p">(</span><span class="s1">&#39;(x-1)*(x+1)&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>x**2 - 1</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">factor</span><span class="p">(</span><span class="s1">&#39;x**2-1&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(x - 1)*(x + 1)</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Implementation-of-the-Lagrange-interpolating-polynomials-and--Lagrange-polynomials-in-SymPy">Implementation of the Lagrange interpolating polynomials and  Lagrange polynomials in SymPy<a class="anchor-link" href="#Implementation-of-the-Lagrange-interpolating-polynomials-and--Lagrange-polynomials-in-SymPy"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%writefile</span> LagrangePolynomial.py
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">From: https://gist.github.com/folkertdev/084c53887c49a6248839</span>
<span class="sd">A sympy-based Lagrange polynomial constructor. </span>

<span class="sd">Implementation of Lagrangian interpolating polynomial.</span>
<span class="sd">See:</span>

<span class="sd">   def lagrangePolynomial(xs, ys):</span>

<span class="sd">Given two 1-D arrays `xs` and `ys,` returns the Lagrange interpolating</span>
<span class="sd">polynomial through the points ``(xs, ys)``</span>


<span class="sd">Given a set 1-D arrays of inputs and outputs, the lagrangePolynomial function </span>
<span class="sd">will construct an expression that for every input gives the corresponding output. </span>
<span class="sd">For intermediate values, the polynomial interpolates (giving varying results </span>
<span class="sd">based  on the shape of your input). </span>

<span class="sd">The Lagrangian polynomials can be obtained explicitly with (see below):</span>
<span class="sd">   </span>
<span class="sd">   def polyL(xs,j):</span>
<span class="sd">   </span>
<span class="sd">as sympy polynomial, and </span>

<span class="sd">    def L(xs,j):</span>

<span class="sd">as Python functions.</span>


<span class="sd">This is useful when the result needs to be used outside of Python, because the </span>
<span class="sd">expression can easily be copied. To convert the expression to a python function </span>
<span class="sd">object, use sympy.lambdify.</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">symbols</span><span class="p">,</span> <span class="n">expand</span><span class="p">,</span> <span class="n">lambdify</span><span class="p">,</span> <span class="n">solve_poly_system</span>
<span class="c1">#Python library for arithmetic with arbitrary precision</span>
<span class="kn">from</span> <span class="nn">mpmath</span> <span class="k">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">e</span>

<span class="kn">import</span> <span class="nn">math</span>

<span class="kn">from</span> <span class="nn">operator</span> <span class="k">import</span> <span class="n">mul</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="k">import</span> <span class="n">reduce</span><span class="p">,</span> <span class="n">lru_cache</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="k">import</span> <span class="n">chain</span>

<span class="c1"># sympy symbols</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="c1"># convenience functions</span>
<span class="n">product</span> <span class="o">=</span> <span class="k">lambda</span> <span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">reduce</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="o">*</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># test data</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">),</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
<span class="n">points</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">]</span>

<span class="c1"># this product may be reusable (when creating many functions on the same domain)</span>
<span class="c1"># therefore, cache the result</span>
<span class="nd">@lru_cache</span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">l</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">gen</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
        <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
        <span class="n">current</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">labels</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">current</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">yield</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">current</span> <span class="o">-</span> <span class="n">m</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">expand</span><span class="p">(</span><span class="n">product</span><span class="p">(</span><span class="n">gen</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">j</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">polyL</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Lagrange polynomials as sympy polynomial</span>
<span class="sd">    xs: the n+1 nodes of the intepolation polynomial in the Lagrange Form</span>
<span class="sd">    j: Is the j-th Lagrange polinomial for the specific xs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">xs</span><span class="o">=</span><span class="nb">tuple</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">j</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">L</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">j</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Lagrange polynomials as python function</span>
<span class="sd">    xs: the n+1 nodes of the intepolation polynomial in the Lagrange Form</span>
<span class="sd">    j: Is the j-th Lagrange polinomial for the specific xs.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">polyL</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="p">)</span>

<span class="k">def</span> <span class="nf">lagrangePolynomial</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Given two 1-D arrays `x` and `w,` returns the Lagrange interpolating</span>
<span class="sd">    polynomial through the points ``(x, w)``.</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># based on https://en.wikipedia.org/wiki/Lagrange_polynomial#Example_1</span>
    <span class="n">k</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="n">total</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># use tuple, needs to be hashable to cache</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">current</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ys</span><span class="p">):</span>
        <span class="n">t</span> <span class="o">=</span> <span class="n">current</span> <span class="o">*</span> <span class="n">l</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span>
        <span class="n">total</span> <span class="o">+=</span> <span class="n">t</span>

    <span class="k">return</span> <span class="n">total</span>




<span class="k">def</span> <span class="nf">x_intersections</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="s2">&quot;Finds all x for which function(x) = 0&quot;</span>
    <span class="c1"># solve_poly_system seems more efficient than solve for larger expressions</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">solve_poly_system</span><span class="p">([</span><span class="n">function</span><span class="p">],</span> <span class="o">*</span><span class="n">args</span><span class="p">))</span> <span class="k">if</span> <span class="p">(</span><span class="n">var</span><span class="o">.</span><span class="n">is_real</span><span class="p">)]</span>

<span class="k">def</span> <span class="nf">x_scale</span><span class="p">(</span><span class="n">function</span><span class="p">,</span> <span class="n">factor</span><span class="p">):</span>
    <span class="s2">&quot;Scale function on the x-axis&quot;</span>
    <span class="k">return</span> <span class="n">functions</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">/</span> <span class="n">factor</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">func</span> <span class="o">=</span> <span class="n">lagrangePolynomial</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">points</span><span class="p">)</span>

    <span class="n">pyfunc</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
        <span class="k">assert</span><span class="p">(</span><span class="n">pyfunc</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="mf">1e-6</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Writing LagrangePolynomial.py
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">LagrangePolynomial</span> <span class="k">as</span> <span class="nn">LP</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="k">import</span> <span class="n">interpolate</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Populating the interactive namespace from numpy and matplotlib
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/usr/local/lib/python3.6/dist-packages/IPython/core/magics/pylab.py:161: UserWarning: pylab import has clobbered these variables: [&#39;cos&#39;, &#39;sin&#39;]
`%matplotlib` prevents importing * from pylab and numpy
  &#34;\n`%matplotlib` prevents importing * from pylab and numpy&#34;
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-of-interpolation-of-tree-points-with-a-polynomial-of-degree-2">Example of interpolation of tree points with a polynomial of degree 2<a class="anchor-link" href="#Example-of-interpolation-of-tree-points-with-a-polynomial-of-degree-2"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span> <span class="s1">&#39;X&#39;</span><span class="p">:[</span><span class="mi">3</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mf">21.3</span><span class="p">],</span><span class="s1">&#39;Y&#39;</span><span class="p">:[</span><span class="mf">8.</span><span class="p">,</span><span class="mf">6.5</span><span class="p">,</span><span class="mf">3.</span><span class="p">]}</span>  <span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.3</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numpy-implementation:"><code>Numpy</code> implementation:<a class="anchor-link" href="#Numpy-implementation:"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">coeffs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="n">deg</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="n">P</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coeffs</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">P</span><span class="p">(</span> <span class="n">x</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">coeffs</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>           2
-0.005216 x - 0.1465 x + 8.486
</pre>
</div>
</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/features/LagrangePoly_14_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Scipy-implementation-of-the-Interpolation-polynomial-in-the-Lagrange-form"><code>Scipy</code> implementation of the Interpolation polynomial in the Lagrange form<a class="anchor-link" href="#Scipy-implementation-of-the-Interpolation-polynomial-in-the-Lagrange-form"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span>interpolate.lagrange<span class="o">?</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">P</span><span class="o">=</span><span class="n">interpolate</span><span class="o">.</span><span class="n">lagrange</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>           2
-0.005216 x - 0.1465 x + 8.486
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Sympy-implementation-of-the-Interpolation-polynomial-in-the-Lagrange-form"><code>Sympy</code> implementation of the Interpolation polynomial in the Lagrange form<a class="anchor-link" href="#Sympy-implementation-of-the-Interpolation-polynomial-in-the-Lagrange-form"> </a></h3>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">lagrangePolynomial</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-0.00521578136549848*x**2 - 0.146480556534234*x + 8.48638370189219</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>With this simpy implementation we can check expliclty that:
$$P_2(x) =  L_{2,0}(x)f(x_0)+L_{2,1}(x)f(x_1)+L_{2,2}(x)f(x_2)$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>a) By using <code>sympy</code> polynomials:  <code>LP.polyL</code>:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">polyL</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">LP</span><span class="o">.</span><span class="n">polyL</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">LP</span><span class="o">.</span><span class="n">polyL</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-0.00521578136549848*x**2 - 0.146480556534234*x + 8.48638370189219</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">polyL</span><span class="p">(</span> <span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0078064012490242*x**2 - 0.244340359094457*x + 1.66276346604215</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As a function</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">P_2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span> <span class="n">xs</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">ys</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span><span class="mi">30</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">P_2</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">),</span><span class="s1">&#39;b-&#39;</span><span class="p">)</span>
<span class="c1">#plt.grid()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">12</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(0.0, 12.0)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/features/LagrangePoly_26_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Lagrange-polynomial-properties">Lagrange polynomial properties<a class="anchor-link" href="#Lagrange-polynomial-properties"> </a></h2>$$L_{n,i}(x_i) = 1\,,\qquad\text{and}\,,\qquad L_{n,i}(x_j) = 0\quad\text{for $i\neq j$}$$<p></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As <code>sympy</code> objects</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L2_0</span><span class="o">=</span><span class="n">LP</span><span class="o">.</span><span class="n">polyL</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">L2_0</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.0078064012490242*x**2 - 0.244340359094457*x + 1.66276346604215</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L2_0</span><span class="o">.</span><span class="n">as_poly</span><span class="p">()(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>1.00000000000000</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">L2_0</span><span class="o">.</span><span class="n">as_poly</span><span class="p">()(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>-4.44089209850063e-16</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As <code>python</code> function</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span> <span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>0.9999999999999969 0.9999999999999951 0.9999999999999996
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">0</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    1.000000e+00
1   -4.440892e-16
2    5.329071e-15
Name: X, dtype: float64</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">1</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0   -4.302114e-16
1    1.000000e+00
2   -2.042810e-14
Name: X, dtype: float64</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">LP</span><span class="o">.</span><span class="n">L</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="mi">2</span><span class="p">)(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0    1.665335e-16
1    0.000000e+00
2    1.000000e+00
Name: X, dtype: float64</pre>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Actividad</strong> Fit a cuatro puntos, comprobando las propiedades del ploinomio de Lagrange</p>

</div>
</div>
</div>
</div>

 


    </main>
    